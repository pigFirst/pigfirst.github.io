window.__require=function t(e,o,n){function i(r,c){if(!o[r]){if(!e[r]){var a=r.split("/");if(a=a[a.length-1],!e[a]){var h="function"==typeof __require&&__require;if(!c&&h)return h(a,!0);if(s)return s(a,!0);throw new Error("Cannot find module '"+r+"'")}r=a}var p=o[r]={exports:{}};e[r][0].call(p.exports,function(t){return i(e[r][1][t]||t)},p,p.exports,t,e,o,n)}return o[r].exports}for(var s="function"==typeof __require&&__require,r=0;r<n.length;r++)i(n[r]);return i}({BackgroundView:[function(t,e,o){"use strict";cc._RF.push(e,"5a9134UL1lLeIUJyPzLGTuB","BackgroundView");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(t,e,o,n){var i,s=arguments.length,r=s<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,n);else for(var c=t.length-1;c>=0;c--)(i=t[c])&&(r=(s<3?i(r):s>3?i(e,o,r):i(e,o))||r);return s>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var s=t("./Model"),r=cc._decorator,c=r.ccclass,a=r.property,h=r.menu,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.startColor=null,e.endColor=null,e.MIN_STARS=10,e.MAX_STARS=20,e._starsCount=0,e.stars=[],e.pastTime=0,e}return n(e,t),e.prototype.onLoad=function(){this.moonBtn=this.node.getChildByName("moon"),this.playBtn=this.moonBtn.getChildByName("play").getComponent(cc.Button),this.starsGraphics=this.node.getComponent(cc.Graphics),this.starsGraphics.fillColor=cc.Color.WHITE,this.color=cc.Color.clone(this.startColor),this.createStars(),this.node.x=-this.node.width/2,this.node.y=-this.node.height/2,this.showPlayBtn(s.default.DELAY_BEFORE_CAN_START)},e.prototype.init=function(t){this.model=t},e.prototype.update=function(t){if(this._state!=this.model.state){switch(this.model.state){case s.GameState.WAIT:break;case s.GameState.START:this.reset(),this.playBtn.node.stopAllActions(),this.moonBtn.stopAllActions(),this.playBtn.node.active=!1,this.moonBtn.scale=1;break;case s.GameState.START:case s.GameState.PLAYING:break;case s.GameState.WIN:this.showPlayBtn(3);break;case s.GameState.LOSE:this.showPlayBtn(2)}this._state=this.model.state}this._starsCount!=this.model.collectedStars&&(this._starsCount=this.model.collectedStars,this.updateBackColor()),this.updateStars(t)},e.prototype.reset=function(){this.pastTime=0,this.updateBackColor()},e.prototype.updateBackColor=function(){this._starsCount<=0?this.color.set(this.startColor):this._starsCount>=100?this.color.set(this.endColor):(this.color.setR(this._starsCount*(this.endColor.r-this.startColor.r)/s.default.MAX_STARS+this.startColor.r),this.color.setG(this._starsCount*(this.endColor.g-this.startColor.g)/s.default.MAX_STARS+this.startColor.g),this.color.setB(this._starsCount*(this.endColor.b-this.startColor.b)/s.default.MAX_STARS+this.startColor.b))},e.prototype.updateStars=function(t){this.pastTime+=t,this.pastTime>.02&&(this.pastTime=0,this.drawStars())},e.prototype.showPlayBtn=function(t){var e=this;this.playBtn.enabled=!1,this.playBtn.node.opacity=0,this.playBtn.node.active=!0,cc.tween(this.playBtn.node).delay(t).call(function(){e.playBtn.enabled=!0}).to(.5,{opacity:255}).start(),cc.tween(this.moonBtn).delay(t).to(.5,{scaleX:1.3,scaleY:1.3}).to(.5,{scaleX:1,scaleY:1}).start()},e.prototype.onPlayClick=function(){this.model.updateState(s.GameState.START)},e.prototype.createStars=function(){for(var t=this.moonBtn.width/3,e=Math.floor(Math.random()*(this.MAX_STARS-this.MIN_STARS)+this.MIN_STARS),o=0;o<e;o++){for(var n=0,i=this.getRndStarCoords();n<o;){var s=Math.abs(i.x-this.stars[n].x),r=Math.abs(i.y-this.stars[n].y),c=Math.abs(i.x-this.moonBtn.position.x),a=Math.abs(i.y-this.moonBtn.position.y);s<10&&r<16||c<t&&a<t?(i=this.getRndStarCoords(),n=0):n++}this.stars.push(i)}this.drawStars()},e.prototype.getRndStarCoords=function(){return new cc.Vec2(Math.floor(Math.random()*(this.starsGraphics.node.width-4)+2),Math.floor(Math.random()*(this.starsGraphics.node.height-78)+75))},e.prototype.drawStars=function(){this.starsGraphics.clear(),this.starsGraphics.fillColor=this.color,this.starsGraphics.fillRect(0,0,this.node.width,this.node.height),this.starsGraphics.fillColor=cc.Color.WHITE;for(var t=0,e=this.stars;t<e.length;t++){var o=e[t],n=0;n=Math.random()>.5?1:2,this.starsGraphics.rect(o.x-n/2,o.y-n/2,n,n)}this.starsGraphics.fill()},i([a(cc.Color)],e.prototype,"startColor",void 0),i([a(cc.Color)],e.prototype,"endColor",void 0),e=i([c,h("BackroundView")],e)}(cc.Component);o.default=p,cc._RF.pop()},{"./Model":"Model"}],FenceView:[function(t,e,o){"use strict";cc._RF.push(e,"85169mq6+VAvIi6wVMes2xP","FenceView");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(t,e,o,n){var i,s=arguments.length,r=s<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,n);else for(var c=t.length-1;c>=0;c--)(i=t[c])&&(r=(s<3?i(r):s>3?i(e,o,r):i(e,o))||r);return s>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var s=t("./GraveView"),r=t("./Model"),c=t("./Main"),a=cc._decorator,h=a.ccclass,p=a.property,l=a.menu,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.fence1=null,e.fence2=null,e}return n(e,t),e.prototype.onLoad=function(){this.gravePrefab=cc.resources.get("co/grave"),this.fence1.active=!0,this.fence2.active=!1},e.prototype.init=function(t){this.model=t},e.prototype.update=function(t){if(this.model.state==r.GameState.PLAYING&&(this.updateFence(),this.hasGrave&&!this.grave.intersecScoredUp&&this.intersectGhost()&&(this.model.reduceStars(),this.grave.onIntersection())),this._state!=this.model.state){switch(this.model.state){case r.GameState.PLAYING:break;case r.GameState.WIN:case r.GameState.LOSE:this.hasGrave&&this.grave.stop()}this._state=this.model.state}},e.prototype.reset=function(){this.putFenceToStart()},e.prototype.updateFence=function(){if(this.grave&&this.grave.node.active)return this.node.x-=this.speed,void(this.fence2.active&&this.fence2.convertToWorldSpaceAR(new cc.Vec2(0,0)).x<=c.default.SIZE.x/2&&this.putFenceToStart());this.fence1.x-=this.speed,this.fence1.x<-40&&(this.fence1.x=0)},e.prototype.putFenceToStart=function(){this.fence1.x=0,this.node.x=0,this.fence2.active=!1,this.hasGrave&&(this.grave.getComponent(s.default).reset(),this.grave.node.active=!1)},Object.defineProperty(e.prototype,"speed",{get:function(){return 1.5+5*this.model.speed},enumerable:!1,configurable:!0}),e.prototype.showGrave=function(){if(null==this.grave||!this.grave.node.active){null==this.grave&&(this.grave=this.createGrave(),this.node.addChild(this.grave.node)),this.grave.node.active=!0,this.grave.node.x=this.fence1.width/2+this.grave.node.width,this.fence2.active=!0,this.fence2.x=this.grave.node.x+this.grave.node.width+this.fence2.width/2;var t=(this.grave.node.x+this.grave.node.width/2-c.default.SIZE.x/2+Math.random()*(c.default.SIZE.x-this.grave.node.width)/4)/this.speed;this.grave.getComponent(s.default).show(t/60)}},e.prototype.intersectGhost=function(){return!!this.hasGrave&&this.grave.intersects()},e.prototype.createGrave=function(){var t=cc.instantiate(this.gravePrefab).getComponent(s.default);return t.init(this.model),t},Object.defineProperty(e.prototype,"hasGrave",{get:function(){return this.grave&&this.grave.node.active},enumerable:!1,configurable:!0}),i([p(cc.Node)],e.prototype,"fence1",void 0),i([p(cc.Node)],e.prototype,"fence2",void 0),e=i([h,l("FenceView")],e)}(cc.Component);o.default=u,cc._RF.pop()},{"./GraveView":"GraveView","./Main":"Main","./Model":"Model"}],GraveView:[function(t,e,o){"use strict";cc._RF.push(e,"f6e06p5UgtPGKx5Mh6UqyZF","GraveView");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(t,e,o,n){var i,s=arguments.length,r=s<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,n);else for(var c=t.length-1;c>=0;c--)(i=t[c])&&(r=(s<3?i(r):s>3?i(e,o,r):i(e,o))||r);return s>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var s=cc._decorator,r=s.ccclass,c=s.property,a=s.menu,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.grave1=null,e.grave2=null,e.ghost=null,e._intersecScoredUp=!1,e.intersecRadius=0,e.point=new cc.Vec2(0,0),e}return n(e,t),Object.defineProperty(e.prototype,"intersecScoredUp",{get:function(){return this._intersecScoredUp},enumerable:!1,configurable:!0}),e.prototype.onLoad=function(){this.reset()},e.prototype.init=function(t){this.model=t},e.prototype.stop=function(){this.ghost.stopAllActions(),cc.tween(this.ghost).to(.2,{opacity:0}).start()},e.prototype.intersects=function(){return cc.Intersection.circleCircle(this.circle,this.model.witchCircle)},Object.defineProperty(e.prototype,"circle",{get:function(){return{position:this.ghost.convertToWorldSpaceAR(this.point),radius:this.intersecRadius}},enumerable:!1,configurable:!0}),e.prototype.show=function(t){Math.random()>.5?this.grave1.active=!0:this.grave2.active=!0,this.ghost.active=!0,this.ghost.scale=.4*Math.random()+.6,this.intersecRadius=this.ghost.width*this.ghost.scale,this.point.y=-this.ghost.height*this.ghost.scale/2;var e=this.ghost.height*this.ghost.scale+Math.random()*(this.ghost.parent.height-this.ghost.height*this.ghost.scale);cc.tween(this.ghost).delay(t).to(this.time,{opacity:70*Math.random()+80,y:e}).repeatForever(cc.tween().by(this.time/2,{y:5}).by(this.time/2,{y:-5})).start()},e.prototype.onIntersection=function(){this._intersecScoredUp=!0},Object.defineProperty(e.prototype,"time",{get:function(){return.5-.2*this.model.speed},enumerable:!1,configurable:!0}),e.prototype.reset=function(){this._intersecScoredUp=!1,this.ghost.stopAllActions(),this.grave1.active=!1,this.grave2.active=!1,this.ghost.active=!1,this.ghost.x=0,this.ghost.y=0,this.ghost.opacity=0,this.ghost.scale=1},i([c(cc.Node)],e.prototype,"grave1",void 0),i([c(cc.Node)],e.prototype,"grave2",void 0),i([c(cc.Node)],e.prototype,"ghost",void 0),e=i([r,a("GraveView")],e)}(cc.Component);o.default=h,cc._RF.pop()},{}],IRulesBtn:[function(t,e,o){"use strict";cc._RF.push(e,"3236c4AETlCXLZa7SBputPj","IRulesBtn");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(t,e,o,n){var i,s=arguments.length,r=s<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,n);else for(var c=t.length-1;c>=0;c--)(i=t[c])&&(r=(s<3?i(r):s>3?i(e,o,r):i(e,o))||r);return s>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var s=cc._decorator,r=s.ccclass,c=(s.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e=i([r],e)}(cc.Component));o.default=c,cc._RF.pop()},{}],InteractionObjectsView:[function(t,e,o){"use strict";cc._RF.push(e,"c0da1PgzaxKvrYUdaiTFOue","InteractionObjectsView");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(t,e,o,n){var i,s=arguments.length,r=s<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,n);else for(var c=t.length-1;c>=0;c--)(i=t[c])&&(r=(s<3?i(r):s>3?i(e,o,r):i(e,o))||r);return s>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var s=t("./Model"),r=t("./FenceView"),c=t("./Main"),a=t("./TreeView"),h=cc._decorator,p=h.ccclass,l=h.property,u=h.menu,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.treesContainer=null,e.starsContainer=null,e.treesPool=new cc.NodePool,e.trees=[],e.starsPool=new cc.NodePool,e.stars=[],e.timeLimit=0,e.starTime=0,e}var o;return n(e,t),o=e,e.prototype.onLoad=function(){var t=cc.instantiate(cc.resources.get("co/tree"));this.treesContainer.addChild(t),t.x=c.default.SIZE.x/2-t.width/2,t.y=-c.default.SIZE.y/2,this.trees.push(t.getComponent(a.default)),this.fence=cc.instantiate(cc.resources.get("co/fence")).getComponent(r.default),this.fence.node.y=-c.default.SIZE.y/2,this.node.addChild(this.fence.node),this.model&&this.fence.init(this.model)},e.prototype.init=function(t){this.model=t,this.fence&&this.fence.init(this.model)},e.prototype.update=function(t){switch(this.model.state){case s.GameState.START:this.reset();break;case s.GameState.PLAYING:this.updateTrees(),this.updateStars(),this.spawnObsticalesIfNeed(t),this.spawnStarsIfNeed(t),this.updateIntersections();break;case s.GameState.WIN:case s.GameState.LOSE:this.hideStars()}this._state!=this.model.state&&(this._state=this.model.state)},Object.defineProperty(e.prototype,"treeSpeed",{get:function(){return 1+5*this.model.speed},enumerable:!1,configurable:!0}),e.prototype.updateTrees=function(){var t=this;this.trees.forEach(function(e){e.node.x-=t.treeSpeed});for(var e=0;e<this.trees.length;){var o=this.trees[e];o.outOfScreen?(this.trees.splice(e,1),o.node.active=!1,this.treesPool.put(o.node)):e++}},e.prototype.updateIntersections=function(){for(var t=0;t<this.trees.length;t++){var e=this.trees[t];if(cc.Intersection.polygonCircle(e.polygon,this.model.witchCircle)){this.model.updateState(s.GameState.LOSE);var o=e.node.scale>0?-5:5;cc.tween(e.node).to(.2,{angle:o}).to(.2,{angle:0}).start()}}for(t=0;t<this.stars.length;t++){var n=this.stars[t],i=this.model.witchPosition.x-n.x,r=this.model.witchPosition.y-n.y;new cc.Vec2(n.x,n.y);if(i*i+r*r<2500)n.getComponent(cc.Animation).stop(),this.stars.splice(t,1),n.active=!1,this.starsPool.put(n),this.model.incStars()}},e.prototype.spawnObsticalesIfNeed=function(t){this.timeLimit+=t;var e=o.MIN_TREE_DISTANCE/this.treeSpeed*.0166;if(this.trees.length<o.MAX_TREES&&this.timeLimit>=e)if(this.timeLimit=0,Math.random()>.7){var n=(this.treesPool.size()>0?this.treesPool.get():cc.instantiate(cc.resources.get("co/tree"))).getComponent(a.default);n.node.active=!0,n.randomize(),this.trees.push(n),this.treesContainer.addChild(n.node),n.node.x=c.default.SIZE.x/2+n.node.width/2,n.node.y=-c.default.SIZE.y/2}else!this.fence.hasGrave&&Math.random()>.8&&this.fence.showGrave()},e.prototype.spawnStarsIfNeed=function(t){this.starTime+=t;var e=c.default.SIZE.x/3/this.starsSpeed*.0166;if((this.stars.length<o.MAX_STARS&&this.starTime>=e||this.model.collectedStars==s.default.MAX_STARS-1&&0==this.stars.length)&&(this.starTime=0,Math.random()>.3)){var n=this.starsPool.size()>0?this.starsPool.get():cc.instantiate(cc.resources.get("co/star"));n.active=!0,n.getComponent(cc.Animation).play(),n.scaleX=Math.random()>.5?-1:1,this.stars.push(n),this.starsContainer.addChild(n),n.x=c.default.SIZE.x+n.width/2,n.y=Math.random()*(c.default.SIZE.y-this.fence.node.height-n.height/2)+this.fence.node.height}},e.prototype.updateStars=function(){var t=this;this.stars.forEach(function(e){e.x-=t.starsSpeed});for(var e=0;e<this.stars.length;){var o=this.stars[e];if(o.x<-c.default.SIZE.x/2-this.node.width/2)this.stars.splice(e,1),o.getComponent(cc.Animation).stop(),o.active=!1,this.starsPool.put(o);else e++}},Object.defineProperty(e.prototype,"starsSpeed",{get:function(){return 1.25+5*this.model.speed},enumerable:!1,configurable:!0}),e.prototype.hideStars=function(){var t=this;cc.tween(this.starsContainer).to(.1,{opacity:0}).call(function(){t.killStars()}).start()},e.prototype.reset=function(){var t=this;this.starsContainer.opacity=255,this.timeLimit=0,this.starTime=0,this.killStars(),this.trees.forEach(function(e){t.treesPool.put(e.node)}),this.trees.length=0;var e=this.treesPool.get();this.treesContainer.addChild(e),e.x=c.default.SIZE.x/2-e.width/2,e.y=-c.default.SIZE.y/2,this.trees.push(e.getComponent(a.default)),this.fence.reset(),this.fence.node.y=-c.default.SIZE.y/2},e.prototype.killStars=function(){var t=this;this.stars.forEach(function(e){e.getComponent(cc.Animation).stop(),t.starsPool.put(e)}),this.stars.length=0},e.MAX_TREES=3,e.MAX_STARS=4,e.MIN_TREE_DISTANCE=150,i([l(cc.Node)],e.prototype,"treesContainer",void 0),i([l(cc.Node)],e.prototype,"starsContainer",void 0),e=o=i([p,u("InteractionObjectsView")],e)}(cc.Component);o.default=d,cc._RF.pop()},{"./FenceView":"FenceView","./Main":"Main","./Model":"Model","./TreeView":"TreeView"}],Main:[function(t,e,o){"use strict";cc._RF.push(e,"7030eYlDJ1M/o1H51/5Ta6U","Main");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(t,e,o,n){var i,s=arguments.length,r=s<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,n);else for(var c=t.length-1;c>=0;c--)(i=t[c])&&(r=(s<3?i(r):s>3?i(e,o,r):i(e,o))||r);return s>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var s=t("./Model"),r=t("./RulesView"),c=t("./BackgroundView"),a=t("./InteractionObjectsView"),h=t("./ScoreView"),p=t("./WitchView"),l=t("./PlayControls"),u=cc._decorator,d=u.ccclass,f=u.property,y=u.menu,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isDesktop=!0,e}var o;return n(e,t),o=e,e.prototype.onLoad=function(){var t=this;s.default.isDesktop=this.isDesktop,this.model=new s.default,o.SIZE=new cc.Vec2(this.node.width,this.node.height),cc.resources.load(["co/rules","co/keyboard","co/broom","co/back","co/obsticals","co/fence","co/grave","co/score","co/witch","co/playControls","co/tree","co/star"],function(e,o){e?console.log("ERROR: can't load prefabs: "+e.message):t.onPrefabsLoaded(e,o)})},e.prototype.onPrefabsLoaded=function(t,e){t?console.log("ERROR: can't load prefab co/keyboard: "+t.message):this.init(e)},e.prototype.init=function(t){var e=cc.instantiate(cc.resources.get("co/back"));e.getComponent(c.default).init(this.model),this.node.addChild(e);var o=cc.instantiate(cc.resources.get("co/witch"));o.getComponent(p.default).init(this.model),this.node.addChild(o);var n=cc.instantiate(cc.resources.get("co/obsticals"));n.getComponent(a.default).init(this.model),this.node.addChild(n);var i=cc.instantiate(cc.resources.get("co/rules"));i.getComponent(r.default).init(this.model),this.node.addChild(i);var s=cc.instantiate(cc.resources.get("co/playControls"));s.getComponent(l.default).init(this.model),this.node.addChild(s);var u=cc.instantiate(cc.resources.get("co/score"));u.getComponent(h.default).init(this.model),this.node.addChild(u)},e.prototype.update=function(t){var e=this;if(this._state!=this.model.state){switch(this.model.state){case s.GameState.START:cc.tween(this.node).delay(s.default.START_DURATION).call(function(){e.model.updateState(s.GameState.PLAYING)}).start()}this._state=this.model.state}},i([f],e.prototype,"isDesktop",void 0),e=o=i([d,y("Main")],e)}(cc.Component);o.default=_,cc._RF.pop()},{"./BackgroundView":"BackgroundView","./InteractionObjectsView":"InteractionObjectsView","./Model":"Model","./PlayControls":"PlayControls","./RulesView":"RulesView","./ScoreView":"ScoreView","./WitchView":"WitchView"}],Model:[function(t,e,o){"use strict";cc._RF.push(e,"579908fNJxGEJAP0KRiQxRF","Model");var n=this&&this.__decorate||function(t,e,o,n){var i,s=arguments.length,r=s<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,n);else for(var c=t.length-1;c>=0;c--)(i=t[c])&&(r=(s<3?i(r):s>3?i(e,o,r):i(e,o))||r);return s>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0}),o.GameState=void 0;var i,s=cc._decorator,r=s.ccclass;s.property;(function(t){t[t.WAIT=0]="WAIT",t[t.START=1]="START",t[t.PLAYING=2]="PLAYING",t[t.WIN=3]="WIN",t[t.LOSE=4]="LOSE"})(i=o.GameState||(o.GameState={}));var c=function(){function t(){this._collectedStars=0,this.speed=0,this.witchPosition=new cc.Vec2,this._state=i.WAIT}var e;return e=t,Object.defineProperty(t.prototype,"collectedStars",{get:function(){return this._collectedStars},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"witchCircle",{get:function(){return{position:this.witchPosition,radius:10}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"state",{get:function(){return this._state},enumerable:!1,configurable:!0}),t.prototype.updateState=function(t){switch(console.log("new state "+t),t){case i.START:this._collectedStars=0,this._state=i.START;break;case i.PLAYING:this._state=i.PLAYING,this.speed=0;break;case i.LOSE:this._state==i.PLAYING&&(this._state=i.LOSE,this.speed=0);break;case i.WIN:this._state==i.PLAYING&&(this._state=i.WIN,this.speed=0)}},t.prototype.reduceStars=function(){this._collectedStars>=10?this._collectedStars-=10:this._collectedStars=0},t.prototype.incStars=function(){this._collectedStars++;var t=this.collectedStars/e.MAX_STARS;this.speed<t&&(this.speed=t),this._collectedStars==e.MAX_STARS&&this.updateState(i.WIN)},t.isDesktop=!0,t.DELAY_BEFORE_CAN_START=1.5,t.START_DURATION=1,t.MAX_STARS=100,t=e=n([r],t)}();o.default=c,cc._RF.pop()},{}],PlayControls:[function(t,e,o){"use strict";cc._RF.push(e,"81aacsGszZF3rB/+GlBhrtf","PlayControls");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(t,e,o,n){var i,s=arguments.length,r=s<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,n);else for(var c=t.length-1;c>=0;c--)(i=t[c])&&(r=(s<3?i(r):s>3?i(e,o,r):i(e,o))||r);return s>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0}),o.DirectionEnum=void 0;var s,r=t("./Model"),c=t("./Main"),a=cc._decorator,h=a.ccclass,p=(a.property,a.menu),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.onLoad=function(){this._upBtn=this.node.getChildByName("up"),this._downBtn=this.node.getChildByName("down"),this._upBtn.active=!1,this._downBtn.active=!1},e.prototype.init=function(t){this.model=t},e.prototype.update=function(t){if(this._state!=this.model.state){switch(this.model.state){case r.GameState.START:r.default.isDesktop||(this._upBtn.active=!0,this._downBtn.active=!0,this._upBtn.x=-c.default.SIZE.x/2+this._upBtn.width/4,this._upBtn.y=-125,this._downBtn.getChildByName("button").angle=-90,this._downBtn.x=c.default.SIZE.x/2-this._upBtn.width/4,this._downBtn.y=this._upBtn.y,this._upBtn.opacity=0,this._downBtn.opacity=0,cc.tween(this._upBtn).delay(r.default.START_DURATION/2).to(r.default.START_DURATION/2,{opacity:255}).start(),cc.tween(this._downBtn).delay(r.default.START_DURATION/2).to(r.default.START_DURATION/2,{opacity:255}).start());break;case r.GameState.PLAYING:this.startListening();break;default:this.stopListening()}this._state=this.model.state}},e.prototype.startListening=function(){r.default.isDesktop?(cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this),cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP,this.onKeyUp,this)):(this._upBtn.on(cc.Node.EventType.TOUCH_START,function(t){cc.systemEvent.dispatchEvent(new cc.Event(s.UP,!1))}),this._upBtn.on(cc.Node.EventType.TOUCH_END,function(t){cc.systemEvent.dispatchEvent(new cc.Event(s.FORWARD,!1))}),this._downBtn.on(cc.Node.EventType.TOUCH_START,function(t){cc.systemEvent.dispatchEvent(new cc.Event(s.DOWN,!1))}),this._downBtn.on(cc.Node.EventType.TOUCH_END,function(t){cc.systemEvent.dispatchEvent(new cc.Event(s.FORWARD,!1))}))},e.prototype.stopListening=function(){r.default.isDesktop?(cc.systemEvent.off(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this),cc.systemEvent.off(cc.SystemEvent.EventType.KEY_UP,this.onKeyUp,this)):(this._upBtn.active=!1,this._downBtn.active=!1)},e.prototype.onKeyDown=function(t){switch(t.keyCode){case cc.macro.KEY.down:cc.systemEvent.dispatchEvent(new cc.Event(s.DOWN,!1));break;case cc.macro.KEY.up:cc.systemEvent.dispatchEvent(new cc.Event(s.UP,!1))}},e.prototype.onKeyUp=function(t){cc.systemEvent.dispatchEvent(new cc.Event(s.FORWARD,!1))},e.prototype.onBtnUp=function(){},e.prototype.onBtnDown=function(){},e.prototype.onBtnRelease=function(){},e=i([h,p("PlayControls")],e)}(cc.Component);o.default=l,function(t){t.FORWARD="forward",t.UP="up",t.DOWN="down"}(s=o.DirectionEnum||(o.DirectionEnum={})),cc._RF.pop()},{"./Main":"Main","./Model":"Model"}],RulesBroomView:[function(t,e,o){"use strict";cc._RF.push(e,"0e002ZoQZlGhrMR9+Ko4MmM","RulesBroomView");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(t,e,o,n){var i,s=arguments.length,r=s<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,n);else for(var c=t.length-1;c>=0;c--)(i=t[c])&&(r=(s<3?i(r):s>3?i(e,o,r):i(e,o))||r);return s>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var s=t("./IRulesBtn"),r=t("./Main"),c=cc._decorator,a=c.ccclass,h=(c.property,c.menu),p=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.onLoad=function(){this.broom=this.node.getChildByName("img")},e.prototype.init=function(t){t?this.finalPos=this.node.convertToNodeSpaceAR(new cc.Vec2(this.node.width/4,this.node.height/4)):(this.broom.angle=-90,this.finalPos=this.node.convertToNodeSpaceAR(new cc.Vec2(r.default.SIZE.x-this.node.width/4,this.node.height/4)))},e.prototype.startAnimation=function(){cc.tween(this.broom).repeatForever(cc.tween().to(.4,{opacity:180}).to(.4,{opacity:255})).start()},e.prototype.hideAnimation=function(){this.broom.stopAllActions(),this.node.stopAllActions(),cc.tween(this.node).to(.5,{x:this.finalPos.x,y:this.finalPos.y}).to(.3,{opacity:0}).start()},e.prototype.reset=function(){this.broom.x=0,this.broom.y=0,this.broom.opacity=255},e=i([a,h("RulesBroomView")],e)}(s.default);o.default=p,cc._RF.pop()},{"./IRulesBtn":"IRulesBtn","./Main":"Main"}],RulesKeyboardView:[function(t,e,o){"use strict";cc._RF.push(e,"e0cfauOi7xIepLsDkYeHako","RulesKeyboardView");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(t,e,o,n){var i,s=arguments.length,r=s<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,n);else for(var c=t.length-1;c>=0;c--)(i=t[c])&&(r=(s<3?i(r):s>3?i(e,o,r):i(e,o))||r);return s>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var s=t("./IRulesBtn"),r=cc._decorator,c=r.ccclass,a=(r.property,r.menu),h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.onLoad=function(){},e.prototype.init=function(t){this.activeNode=this.node.getChildByName(t?"up":"down"),this.minOpacity=this.activeNode.opacity},e.prototype.startAnimation=function(){cc.tween(this.activeNode).repeatForever(cc.tween().to(.4,{opacity:255}).to(.4,{opacity:this.minOpacity})).start()},e.prototype.hideAnimation=function(){this.activeNode.stopAllActions(),this.activeNode.opacity=this.minOpacity,cc.tween(this.node).to(.5,{opacity:0}).start()},e.prototype.reset=function(){this.activeNode.opacity=this.minOpacity,this.node.opacity=255},e=i([c,a("RulesKeybardView")],e)}(s.default);o.default=h,cc._RF.pop()},{"./IRulesBtn":"IRulesBtn"}],RulesView:[function(t,e,o){"use strict";cc._RF.push(e,"3ccdbm3/shPYoLOs3ZqO7Cw","RulesView");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(t,e,o,n){var i,s=arguments.length,r=s<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,n);else for(var c=t.length-1;c>=0;c--)(i=t[c])&&(r=(s<3?i(r):s>3?i(e,o,r):i(e,o))||r);return s>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var s=t("./Model"),r=t("./IRulesBtn"),c=cc._decorator,a=c.ccclass,h=(c.property,c.menu),p=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.onLoad=function(){this.state=this.model.state;var t=this.node.getChildByName("rulesUp"),e=this.node.getChildByName("rulesDown");this.upArrow=t.getChildByName("arrow"),this.downArrow=e.getChildByName("arrow"),this.upY=this.upArrow.y,this.downY=this.downArrow.y,this.btnUp=t.getChildByName("button"),this.btnDown=e.getChildByName("button");var o=s.default.isDesktop?"co/keyboard":"co/broom",n=cc.resources.get(o);this.onPrefabLoaded(n),cc.tween(this.upArrow).repeatForever(cc.tween().to(.4,{y:this.upY-5}).to(.4,{y:this.upY})).start(),cc.tween(this.downArrow).repeatForever(cc.tween().to(.4,{y:this.downY+5}).to(.4,{y:this.downY})).start()},e.prototype.init=function(t){this.model=t},e.prototype.onPrefabLoaded=function(t){var e=cc.instantiate(t),o=cc.instantiate(t);this.up=e.getComponent(r.default),this.down=o.getComponent(r.default),this.btnUp.addChild(e),this.btnDown.addChild(o),this.up.init(!0),this.down.init(!1),this.up.startAnimation(),this.down.startAnimation()},e.prototype.start=function(){},e.prototype.update=function(t){if(this.state!=this.model.state){switch(this.model.state){case s.GameState.START:this.hide()}this.state=this.model.state}},e.prototype.hide=function(){this.node.stopAllActions(),this.up.hideAnimation(),this.down.hideAnimation(),this.hideArrow(this.upArrow),this.hideArrow(this.downArrow)},e.prototype.hideArrow=function(t){t.stopAllActions(),cc.tween(t).to(.5,{opacity:0}).start()},e=i([a,h("RulesView")],e)}(cc.Component);o.default=p,cc._RF.pop()},{"./IRulesBtn":"IRulesBtn","./Model":"Model"}],ScoreView:[function(t,e,o){"use strict";cc._RF.push(e,"74f6anqnDxI44xvAl2MWQ6q","ScoreView");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(t,e,o,n){var i,s=arguments.length,r=s<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,n);else for(var c=t.length-1;c>=0;c--)(i=t[c])&&(r=(s<3?i(r):s>3?i(e,o,r):i(e,o))||r);return s>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var s=t("./Model"),r=t("./Main"),c=cc._decorator,a=c.ccclass,h=(c.property,c.menu),p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._starsCount=0,e.startTime=0,e.currentTime=0,e}return n(e,t),e.prototype.onLoad=function(){this.star=this.node.getChildByName("stars").getChildByName("star"),this.count=this.node.getChildByName("stars").getChildByName("count").getComponent(cc.Label),this.clocks=this.node.getChildByName("clocks").getChildByName("icon"),this.timer=this.node.getChildByName("clocks").getChildByName("timer").getComponent(cc.Label),this.node.opacity=0,this.node.x=-r.default.SIZE.x/2,this.node.y=r.default.SIZE.y/2},e.prototype.init=function(t){this.model=t},e.prototype.update=function(t){if(this._state!=this.model.state){switch(this.model.state){case s.GameState.START:this.reset(),cc.tween(this.node).to(s.default.START_DURATION,{opacity:255}).start(),this.node.opacity=255;break;case s.GameState.PLAYING:this.startTime=(new Date).getTime();break;case s.GameState.WIN:this.updateStarsCount()}this._state=this.model.state}this.model.state==s.GameState.PLAYING&&(this._starsCount!=this.model.collectedStars&&this.updateStarsCount(),this.updateTime())},e.prototype.updateStarsCount=function(){var t=this;this.star.stopAllActions(),this.count.node.stopAllActions(),this.count.node.opacity=255,this.count.node.scale=1,this.count.string=this._starsCount.toString(),this._starsCount<this.model.collectedStars?(this._starsCount=this.model.collectedStars,cc.tween(this.star).to(.1,{scaleX:1.1,scaleY:1.1}).call(function(){t.count.string=t._starsCount.toString()}).to(.1,{scaleX:1,scaleY:1}).start()):(this._starsCount=this.model.collectedStars,this.star.scale=1,cc.tween(this.count.node).to(.1,{scaleX:.5,scaleY:.5,opacity:180}).call(function(){t.count.string=t._starsCount.toString()}).to(.1,{scaleX:1,scaleY:1,opacity:255}).start())},e.prototype.updateTime=function(){var t=(new Date).getTime()-this.startTime;if(t-this.currentTime>=1e3){this.currentTime=t;var e=Math.floor(t/1e3/60),o=Math.floor((t-60*e*1e3)/1e3);this.timer.string=e.toString()+(o<10?":0":":")+o.toString()}},e.prototype.reset=function(){this.star.scale=1,this.count.node.scale=1,this.count.node.opacity=255,this._starsCount=0,this.count.string=this._starsCount.toString(),this.currentTime=0,this.startTime=0,this.timer.string="0:00",this.node.stopAllActions(),this.node.opacity=0,this.node.x=-r.default.SIZE.x/2,this.node.y=r.default.SIZE.y/2},e=i([a,h("ScoreView")],e)}(cc.Component);o.default=p,cc._RF.pop()},{"./Main":"Main","./Model":"Model"}],SimpleButton:[function(t,e,o){"use strict";cc._RF.push(e,"a771dWqGzNON7wWIzBI/E+4","SimpleButton");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(t,e,o,n){var i,s=arguments.length,r=s<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,n);else for(var c=t.length-1;c>=0;c--)(i=t[c])&&(r=(s<3?i(r):s>3?i(e,o,r):i(e,o))||r);return s>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var s=cc._decorator,r=s.ccclass,c=(s.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.onLoad=function(){},e.prototype.start=function(){},e.prototype.update=function(t){},e=i([r],e)}(cc.Component));o.default=c,cc._RF.pop()},{}],Star:[function(t,e,o){"use strict";cc._RF.push(e,"f9a21BUHTFHCJH7IQo23HhM","Star");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(t,e,o,n){var i,s=arguments.length,r=s<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,n);else for(var c=t.length-1;c>=0;c--)(i=t[c])&&(r=(s<3?i(r):s>3?i(e,o,r):i(e,o))||r);return s>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var s=cc.Vec2,r=cc._decorator,c=r.ccclass,a=r.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.anim=null,e.collectRadius=0,e.minSpawnY=45,e}return n(e,t),e.prototype.onLoad=function(){this.anim.play(),this.node.scaleX=Math.random()>.5?-1:1},e.prototype.getCircle=function(){return{position:this.node.convertToWorldSpaceAR(s.ZERO),radius:this.collectRadius}},e.prototype.start=function(){},e.prototype.update=function(t){},i([a(cc.Animation)],e.prototype,"anim",void 0),i([a],e.prototype,"collectRadius",void 0),i([a],e.prototype,"minSpawnY",void 0),e=i([c],e)}(cc.Component);o.default=h,cc._RF.pop()},{}],TreeView:[function(t,e,o){"use strict";cc._RF.push(e,"9401aiJa8JH2YcChNHUC8p1","TreeView");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(t,e,o,n){var i,s=arguments.length,r=s<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,n);else for(var c=t.length-1;c>=0;c--)(i=t[c])&&(r=(s<3?i(r):s>3?i(e,o,r):i(e,o))||r);return s>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var s=t("./Main"),r=cc._decorator,c=r.ccclass,a=(r.property,r.menu),h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._outOfScreen=!1,e._leftDelta=0,e._rightDelta=0,e._topDelta=0,e}return n(e,t),Object.defineProperty(e.prototype,"outOfScreen",{get:function(){return this._outOfScreen},enumerable:!1,configurable:!0}),e.prototype.onLoad=function(){this._leftDelta=-this.node.width*this.node.scaleX/2,this._rightDelta=this.node.width*this.node.scaleX/2,this._topDelta=.2*this.node.width*this.node.scaleX},e.prototype.update=function(){this.node.active&&(this._outOfScreen=this.node.x<-s.default.SIZE.x/2-this.node.width/2*this.node.scaleY)},Object.defineProperty(e.prototype,"polygon",{get:function(){var t=this.node.convertToWorldSpaceAR(cc.Vec2.ZERO);return[new cc.Vec2(t.x+this._leftDelta,t.y),new cc.Vec2(t.x+this._topDelta,t.y+this.node.height*this.node.scaleY),new cc.Vec2(t.x+this._rightDelta,t.y)]},enumerable:!1,configurable:!0}),e.prototype.randomize=function(){this.node.angle=0;var t=.7+.3*Math.random();this.node.scale=t,Math.random()>.5&&(this.node.scaleX=-this.node.scaleX),this._leftDelta=-this.node.width*this.node.scaleX/2,this._rightDelta=this.node.width*this.node.scaleX/2,this._topDelta=.2*this.node.width*this.node.scaleX,this._outOfScreen=!1},e=i([c,a("TreeView")],e)}(cc.Component);o.default=h,cc._RF.pop()},{"./Main":"Main"}],WitchView:[function(t,e,o){"use strict";cc._RF.push(e,"5be827CSx5DAKZZhYLWR8j1","WitchView");var n=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),i=this&&this.__decorate||function(t,e,o,n){var i,s=arguments.length,r=s<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,n);else for(var c=t.length-1;c>=0;c--)(i=t[c])&&(r=(s<3?i(r):s>3?i(e,o,r):i(e,o))||r);return s>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var s=t("./Model"),r=t("./PlayControls"),c=t("./Main"),a=cc._decorator,h=a.ccclass,p=(a.property,a.menu),l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._direction=null,e.minY=-75,e.maxY=100,e}var o;return n(e,t),o=e,e.prototype.onLoad=function(){this.witch=this.node.getChildByName("witch"),this.bat=this.node.getChildByName("bat"),this.witch.active=!0,this.bat.active=!1,this.node.x=o.WITCH_START_POSITION.x,this.node.y=o.WITCH_START_POSITION.y,this.model.witchPosition.x=this.node.convertToWorldSpaceAR(cc.Vec2.ZERO).x,this.model.witchPosition.y=this.node.convertToWorldSpaceAR(cc.Vec2.ZERO).y,this.updatePositionInModel(),this.swaying=cc.tween(this.node).repeatForever(cc.tween().by(.4,{y:8}).by(.4,{y:-8}))},e.prototype.init=function(t){this.model=t},e.prototype.update=function(t){if(this._state!=this.model.state){switch(this.model.state){case s.GameState.START:this.reset(),this.startSwaying();break;case s.GameState.PLAYING:this.startListenEvents();break;case s.GameState.LOSE:this.stopSwaying(),this.stopListenEvents(),this.showLoseAnimation(),this._direction=r.DirectionEnum.FORWARD;break;case s.GameState.WIN:this.stopListenEvents(),this._direction=r.DirectionEnum.FORWARD,this.showWinAnimation()}this._state=this.model.state}if(this.model.state==s.GameState.PLAYING)switch(this._direction){case r.DirectionEnum.UP:this.node.y+=this.speed,this.node.y>this.maxY&&(this.node.y=this.maxY),this.updatePositionInModel();break;case r.DirectionEnum.DOWN:this.node.y-=this.speed,this.node.y<this.minY&&(this.node.y=this.minY),this.updatePositionInModel();break;case r.DirectionEnum.FORWARD:}},e.prototype.showWinAnimation=function(){var t=this;cc.tween(this.node).delay(.5).call(function(){t.stopSwaying()}).to(.5,{x:225,y:75}).delay(1).to(.3,{x:225,y:170}).delay(2).start(),cc.tween(this.witch).delay(1).to(.2,{angle:359,scale:.3,opacity:150}).call(function(){t.witch.active=!1,t.witch.opacity=255}).start(),this.bat.active=!0,this.bat.opacity=0,this.bat.angle=180,cc.tween(this.bat).delay(1.2).call(function(){t.bat.opacity=255}).to(.2,{angle:359}).call(function(){t.bat.getComponent(cc.Animation).play()}).delay(1).start()},e.prototype.showLoseAnimation=function(){cc.tween(this.node).to(.2,{x:o.WITCH_START_POSITION.x+10,angle:-2}).to(.5,{angle:359,x:-c.default.SIZE.x/2-this.witch.width/2,y:o.WITCH_START_POSITION.y-50}).delay(2).start()},e.prototype.updatePositionInModel=function(){this.model.witchPosition.y=this.node.convertToWorldSpaceAR(cc.Vec2.ZERO).y},e.prototype.startListenEvents=function(){cc.systemEvent.on(r.DirectionEnum.DOWN,this.onKeyDown,this),cc.systemEvent.on(r.DirectionEnum.UP,this.onKeyDown,this),cc.systemEvent.on(r.DirectionEnum.FORWARD,this.onKeyUp,this)},e.prototype.stopListenEvents=function(){cc.systemEvent.off(r.DirectionEnum.DOWN,this.onKeyDown,this),cc.systemEvent.off(r.DirectionEnum.UP,this.onKeyDown,this),cc.systemEvent.off(r.DirectionEnum.FORWARD,this.onKeyUp,this)},Object.defineProperty(e.prototype,"speed",{get:function(){return 2+4*this.model.speed},enumerable:!1,configurable:!0}),e.prototype.onKeyDown=function(t){switch(t.type){case r.DirectionEnum.DOWN:this._direction=r.DirectionEnum.DOWN,this.stopSwaying();break;case r.DirectionEnum.UP:this.stopSwaying(),this._direction=r.DirectionEnum.UP}},e.prototype.onKeyUp=function(t){this.startSwaying(),this._direction=r.DirectionEnum.FORWARD},e.prototype.startSwaying=function(){this.swaying.start()},e.prototype.stopSwaying=function(){null!=this.swaying&&this.swaying.stop()},e.prototype.reset=function(){this.witch.stopAllActions(),this.bat.stopAllActions(),this.witch.active=!0,this.bat.active=!1,this.witch.angle=0,this.bat.angle=0,this.witch.scale=1,this.witch.opacity=255,this.bat.scale=1,this.bat.opacity=255,this.node.x=o.WITCH_START_POSITION.x,this.node.y=o.WITCH_START_POSITION.y,this.node.opacity=255,this.node.angle=0,this.stopSwaying()},e.WITCH_START_POSITION=new cc.Vec2(-150,30),e=o=i([h,p("WitchView")],e)}(cc.Component);o.default=l,cc._RF.pop()},{"./Main":"Main","./Model":"Model","./PlayControls":"PlayControls"}],"use_v2.1-2.2.1_cc.Toggle_event":[function(t,e,o){"use strict";cc._RF.push(e,"1a270mhv6dNjoETm4Vw1chu","use_v2.1-2.2.1_cc.Toggle_event"),cc.Toggle&&(cc.Toggle._triggerEventInScript_isChecked=!0),cc._RF.pop()},{}]},{},["use_v2.1-2.2.1_cc.Toggle_event","BackgroundView","FenceView","GraveView","IRulesBtn","InteractionObjectsView","Main","Model","PlayControls","RulesBroomView","RulesKeyboardView","RulesView","ScoreView","SimpleButton","Star","TreeView","WitchView"]);